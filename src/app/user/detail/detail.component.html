<section class="users-profile grid md:gap-x-4 px-4">
  <aside class="aside">
    <div class="sticky top-0 py-4">
      <div class="flex flex-col space-y-4 bg-primary-3 border border-primary-4 rounded-md p-4" >
        <div class="flex items-center md:items-start space-x-4 md:space-x-0 md:space-y-4 md:flex-col">
          <div class="flex border border-primary-4 overflow-hidden rounded-md h-16 w-16 md:h-44 md:w-44" [appUser]="user" appAvatar></div>
          <div class="flex flex-col flex-1">
            <div class="grid">
              <span class="block text-secondary-1 truncate">{{user.name}}</span>
            </div>
            <time
              class="text-secondary-2 text-sm"
              [attr.datetime]="user.createdAt | dayjs : 'format' : 'YYYY-M-D'">registered {{user.createdAt | dayjs : 'fromX'}}
            </time>
          </div>
        </div>
        <p
          class="border-t border-primary-4 pt-4"
          [ngClass]="user.biography ? 'text-secondary-1' : 'text-secondary-2'"
          [innerHTML]="user.biography || 'User does not have biography'"></p>
      </div>
    </div>
  </aside>
  <div class="view grid grid-cols-1 grid-rows-1 self-start">
    <header class="header bg-primary-2 border-b border-t md:border-t-0 border-primary-4 z-20 sticky -top-px py-4">
      <nav class="flex justify-between items-center border border-primary-4 bg-primary-3 rounded-md">
        <ul class="flex justify-start items-center overflow-auto px-1">
          <li class="inline-block">
            <a
              class="block text-secondary-1 hover:text-info-1 hover:underline p-2"
              [routerLink]="[]"
              [routerLinkActive]="'text-info-1'"
              [routerLinkActiveOptions]="{ exact: true }"
              [queryParams]="{ categoryId: null }"
              [queryParamsHandling]="'merge'"
              [attr.aria-label]="'All'">All
            </a>
          </li>
          <li class="inline-block" *ngFor="let category of categoryList">
            <a
              class="block text-secondary-1 hover:text-info-1 hover:underline p-2"
              [routerLink]="[]"
              [routerLinkActive]="'text-info-1'"
              [queryParams]="{ categoryId: category.id }"
              [queryParamsHandling]="'merge'"
              [attr.aria-label]="category.name">{{category.name}}
            </a>
          </li>
        </ul>
        <ng-container *appAuthed="true">
          <app-dropdown
            class="flex relative"
            *ngIf="{ value: false } as active"
            (toggle)="active.value = $event">
            <button
              class="block fill-current text-secondary-1 hover:text-info-1 cursor-pointer p-2"
              [ngClass]="{ 'text-info-1': active.value }"
              type="button"
              [attr.aria-label]="'Menu'"
              appSvgIcon
              [appIcon]="'list'"
              [appSquare]="'1.5rem'"
              slot="toggle">
            </button>
            <div class="flex flex-col items-end -mt-2" slot="content">
              <div class="w-3 overflow-hidden inline-block mx-3.5">
                <div class="h-2 w-2 bg-primary-2 rotate-45 transform origin-bottom-left"></div>
              </div>
              <ul class="flex flex-col bg-primary-2 rounded-md shadow-lg py-2" slot="content">
                <ng-container *ngIf="isProfile">
                  <li class="block">
                    <a
                      class="block text-secondary-1 hover:text-info-1 hover:underline hover:bg-primary-1 w-full py-2 px-4"
                      [routerLink]="['category/create']"
                      [routerLinkActive]="'text-info-1'"
                      [queryParamsHandling]="'preserve'"
                      aria-label="Create">Create
                    </a>
                  </li>
                  <ng-container *ngIf="routeQueryParams && routeQueryParams.categoryId">
                    <li class="block">
                      <a
                        class="block text-secondary-1 hover:text-info-1 hover:underline hover:bg-primary-1 w-full py-2 px-4"
                        [routerLink]="['category/edit', routeQueryParams.categoryId]"
                        [routerLinkActive]="'text-info-1'"
                        [queryParamsHandling]="'preserve'"
                        aria-label="Edit">Edit
                      </a>
                    </li>
                    <li class="block">
                      <a
                        class="block text-secondary-1 hover:text-info-1 hover:underline hover:bg-primary-1 w-full py-2 px-4"
                        [routerLink]="['category/delete', routeQueryParams.categoryId]"
                        [routerLinkActive]="'text-info-1'"
                        [queryParamsHandling]="'preserve'"
                        aria-label="Delete">Delete
                      </a>
                    </li>
                  </ng-container>
                </ng-container>
                <ng-container *ngIf="!isProfile">
                  <li class="block">
                    <a
                      class="block text-secondary-1 hover:text-info-1 hover:underline hover:bg-primary-1 w-full py-2 px-4"
                      [routerLink]="['.']"
                      aria-label="Inappropriate content">Inappropriate content
                    </a>
                  </li>
                </ng-container>
              </ul>
            </div>
          </app-dropdown>
        </ng-container>
      </nav>
    </header>
    <div class="content">
      <ng-container *ngIf="postList.length; else postListEmpty;">
        <ul class="grid gap-4 grid-cols-posts grid-flow-row-dense py-4">
          <li class="block" *ngFor="let post of postList" [appPost]="post" appCardPost></li>
        </ul>
        <button
          class="btn btn-success block w-full mb-4"
          type="button"
          *ngIf="postListHasMore"
          (click)="onPostListLoadMore()">Load more
        </button>
      </ng-container>
    </div>
  </div>
  <ng-template #postListEmpty>
    <div
      class="bg-primary-3 text-secondary-1 border border-primary-4 rounded-md px-4 py-2 my-4"
      [ngSwitch]="postListLoading">
      <span class="block" *ngSwitchDefault>No posts were found for your request</span>
      <span class="block" *ngSwitchCase="true">Loading</span>
    </div>
  </ng-template>
  <router-outlet></router-outlet>
</section>
