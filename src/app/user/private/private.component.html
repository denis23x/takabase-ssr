<!-- @format -->

<ng-container>
	<div class="rounded-box border border-base-content/20 bg-base-100 p-4 flex flex-col gap-4 shadow-xl">
		<div class="flex w-full items-center justify-between gap-4">
			<button
				class="btn-ghost btn-md btn-square btn bg-base-200 fill-current"
				type="button"
				appSvgIcon
				appSkeleton
				[title]="'Private'"
				[attr.aria-label]="'Private'"
				[disabled]="postListSkeletonToggle"
				[appSkeletonToggle]="postListSkeletonToggle"
				[appSkeletonClassListElementRef]="['border-0']"
				[appSvgIconIcon]="'incognito'"
				[appSvgIconSquare]="'1.5em'"
			></button>
			<div class="flex items-center justify-start gap-4 overflow-hidden w-full">
				<div class="flex flex-col gap-2 items-start overflow-hidden w-full">
					<h2
						class="block truncate text-xl leading-6 font-bold text-base-content max-w-full"
						appSkeleton
						[appSkeletonToggle]="postListSkeletonToggle"
					>
						Private posts
					</h2>
					<span
						class="text-sm text-base-content/50 leading-4 truncate max-w-full"
						appSkeleton
						[appSkeletonToggle]="postListSkeletonToggle"
					>
						Available only for you
					</span>
				</div>
				<div
					class="flex p-0"
					appDropdown
					appSkeleton
					[appSkeletonToggle]="currentUserSkeletonToggle || postListSkeletonToggle"
					[appDropdownPlacement]="'bottom-end'"
				>
					<button
						class="btn-ghost btn-md btn-square btn bg-base-200 fill-current"
						type="button"
						title="Private menu"
						aria-label="Private menu"
						appSvgIcon
						slot="target"
						[appSvgIconIcon]="'three-dots-vertical'"
						[appSvgIconSquare]="'1.5em'"
					></button>
					<ul class="menu menu-vertical menu-md" slot="content">
						<li class="flex w-full snap-start scroll-my-2">
							<button
								class="rounded-btn block w-full truncate text-right"
								type="button"
								title="Work In Progress"
								aria-label="Work In Progress"
							>
								WIP
							</button>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="flex flex-col w-full gap-4">
			@if (postList.length) {
				<ul class="grid grid-cols-2 grid-rows-none gap-4 sm:grid-cols-3 md:grid-cols-4">
					@for (post of postList; track i; let i = $index) {
						<li
							class="block"
							appCardPost
							[ngClass]="post.image ? 'row-span-6' : 'row-span-3'"
							[appCardPostPost]="post"
							[appCardPostSkeletonToggle]="postListSkeletonToggle"
							[appPostUrl]="'./post'"
						></li>
					}
				</ul>
				@defer (on idle; prefetch on timer(1s)) {
					<div
						class="block empty:hidden"
						appLoadMore
						[appLoadMoreSearchResponseIsLoading]="postListIsLoading"
						[appLoadMoreSearchResponse]="postListSearchResponse"
						(appLoadMoreToggle)="getPostList(true)"
					></div>
				}
			} @else {
				<div class="flex flex-col items-center gap-4">
					<i
						class="fill-current text-base-content"
						appSvgIcon
						[appSvgIconIcon]="'exclamation-circle'"
						[appSvgIconSquare]="'3em'"
					></i>
					<div class="text-center">
						<p class="text-xl font-bold text-base-content">Posts <span class="text-error">not found</span></p>
						<a class="link text-sm" title="Create post" aria-label="Create post" [routerLink]="['/create']">
							Create post
						</a>
					</div>
				</div>
			}
		</div>
	</div>
	<div class="block">
		<router-outlet></router-outlet>
	</div>
</ng-container>
