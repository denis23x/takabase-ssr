<!-- @format -->

<ng-container *ngIf="!!post">
	<section class="flex h-full max-w-full flex-col items-start justify-start space-y-4 px-4">
		<header class="flex w-full flex-col items-start justify-start border-b border-base-content/20">
			<div class="mt-4 flex" *ngIf="currentUser?.id === post.user.id">
				<a class="btn-primary btn" aria-label="Settings" [routerLink]="['/edit', post.id]">
					Edit
				</a>
			</div>
			<div class="flex w-full items-start justify-start gap-4 py-4">
				<figure
					class="relative block aspect-square h-20 w-20 sm:h-44 sm:w-44"
					appSkeleton
					*ngIf="!!post.image"
					[appSkeletonToggle]="postSkeletonToggle"
				>
					<img
						class="rounded-btn object-cover object-center"
						[fill]="true"
						[ngSrc]="post.image"
						[alt]="post.name"
					/>
				</figure>
				<div
					class="flex w-full flex-col gap-4 items-start overflow-hidden"
					[ngClass]="!!post.image ? 'col-span-9' : 'col-span-12'"
				>
					<div class="flex flex-col gap-2 items-start">
						<h2
							class="truncate text-2xl font-bold text-base-content"
							appSkeleton
							[appSkeletonToggle]="postSkeletonToggle"
						>
							{{ post.name }}
						</h2>
						<span
							class="text-sm text-base-content/40"
							appSkeleton
							[appSkeletonToggle]="postSkeletonToggle"
						>
							{{ post.category.name }}
						</span>
					</div>
					<p class="alert" appSkeleton [appSkeletonToggle]="postSkeletonToggle">
						<span class="block">{{ post.description }}</span>
					</p>
					<!-- prettier-ignore -->
					<span
						class="text-sm font-bold"
						appSkeleton
						*ngIf="post?.markdown"
						[appSkeletonToggle]="postSkeletonToggle"
					>
						Time to read: {{ post?.markdown | markdown: "time-to-read" }} min.
					</span>
				</div>
			</div>
		</header>
		<article
			class="prose h-full w-full max-w-full overflow-hidden"
			appSkeleton
			[appSkeletonToggle]="postSkeletonToggle"
			[innerHTML]="post?.markdown || 'No post markdown' | markdown | sanitizer: 'html'"
		></article>
		<footer
			class="flex w-full flex-col items-start justify-start space-y-4 border-t border-base-content/20 empty:invisible"
		>
			<div class="flex items-center justify-start gap-4 py-4">
				<a
					class="avatar"
					appSkeleton
					[routerLink]="[post.user | userUrl]"
					[attr.aria-label]="post.user.name"
					[title]="post.user.name"
					[appSkeletonToggle]="postSkeletonToggle"
				>
					<figure
						class="h-14 w-14 rounded-btn relative overflow-hidden"
						appAvatar
						[appUser]="post.user"
					></figure>
				</a>
				<div class="flex flex-col items-start justify-start gap-2">
					<a
						class="link"
						appSkeleton
						[routerLink]="[post.user | userUrl]"
						[attr.aria-label]="post.user.name"
						[title]="post.user.name"
						[appSkeletonToggle]="postSkeletonToggle"
					>
						{{ post.user.name }}
					</a>
					<time
						class="text-sm text-base-content/50"
						appSkeleton
						[appSkeletonToggle]="postSkeletonToggle"
						[attr.datetime]="post.createdAt | dayjs: 'format' : 'YYYY-M-D'"
					>
						published {{ post.createdAt | dayjs: "fromX" }}
					</time>
				</div>
			</div>
		</footer>
	</section>
</ng-container>
