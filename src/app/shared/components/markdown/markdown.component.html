<!-- @format -->

<ng-container>
	<div class="overflow-auto" #controlListElement>
		<ul
			class="menu menu-horizontal bg-base-100 rounded-box border border-base-content/20"
		>
			<li class="inline-block">
				<button
					class="fill-current text-base-content"
					type="button"
					aria-label="Undo"
					title="Undo"
					[disabled]="!history$.getValue().length"
					(click)="onBack()"
					appSvgIcon
					[appIcon]="'arrow-left'"
				></button>
			</li>
			<li class="inline-block">
				<div class="flex p-0" appDropdown #dropdownHeading>
					<button
						class="fill-current text-base-content p-3"
						type="button"
						aria-label="Heading"
						title="Heading"
						appSvgIcon
						[appIcon]="'type-h1'"
						slot="target"
					></button>
					<ul
						class="menu shadow bg-base-100 border border-base-content/20 rounded-box min-w-fit mt-2 p-2"
						slot="content"
					>
						<li class="flex w-full" *ngFor="let control of controlListHeading">
							<button
								class="text-base-content whitespace-nowrap w-full"
								type="button"
								[attr.aria-label]="control.label"
								(click)="onControl(control)"
							>
								<span class="block" [ngClass]="control.classList">
									{{ control.label }}
								</span>
							</button>
						</li>
					</ul>
				</div>
			</li>
			<li class="inline-block">
				<div class="flex p-0" appDropdown #dropdownFormatting>
					<button
						class="fill-current text-base-content p-3"
						type="button"
						aria-label="Formatting"
						title="Formatting"
						appSvgIcon
						[appIcon]="'type-bold'"
						slot="target"
					></button>
					<ul
						class="menu shadow bg-base-100 border border-base-content/20 rounded-box min-w-fit mt-2 p-2"
						slot="content"
					>
						<li
							class="flex w-full"
							*ngFor="let control of controlListFormatting"
						>
							<button
								class="text-base-content whitespace-nowrap w-full"
								type="button"
								[attr.aria-label]="control.label"
								(click)="onControl(control)"
							>
								<span class="block" [ngClass]="control.classList">
									{{ control.label }}
								</span>
							</button>
						</li>
					</ul>
				</div>
			</li>
			<li class="inline-block">
				<div class="flex p-0" appDropdown #dropdownList>
					<button
						class="fill-current text-base-content p-3"
						type="button"
						aria-label="List"
						title="List"
						appSvgIcon
						[appIcon]="'list-ul'"
						slot="target"
					></button>
					<ul
						class="menu shadow bg-base-100 border border-base-content/20 rounded-box min-w-fit mt-2 p-2"
						slot="content"
					>
						<li class="flex w-full" *ngFor="let control of controlListList">
							<button
								class="fill-current text-base-content whitespace-nowrap w-full"
								type="button"
								[attr.aria-label]="control.label"
								[attr.title]="control.label"
								(click)="onControl(control)"
							>
								{{ control.label }}
							</button>
						</li>
					</ul>
				</div>
			</li>
			<li class="inline-block" *ngFor="let control of controlListUrl">
				<button
					class="fill-current text-base-content"
					type="button"
					[attr.aria-label]="control.label"
					[attr.title]="control.label"
					(click)="onControl(control)"
					appSvgIcon
					[appIcon]="control.icon"
				></button>
			</li>
		</ul>
	</div>
	<!-- TODO: update modal -->
	<app-overlay *ngIf="urlModal" (closed)="onCloseUrlForm()">
		<div
			class="absolute inset-0 flex justify-center items-center pointer-events-none p-4"
		>
			<form
				class="max-h-full max-w-full w-full md:w-128 flex flex-col space-y-4 bg-primary-3 rounded-lg shadow-lg pointer-events-auto p-4"
				[formGroup]="urlForm"
				(ngSubmit)="onSubmitUrlForm()"
				autocomplete="off"
			>
				<div
					class="flex justify-between items-center border-b border-primary-4 pb-2"
				>
					<span class="block text-xl text-secondary-1 font-medium leading-9"
						>Add {{ urlFormControl.label }}</span
					>
					<button
						class="fill-current opacity-25 hover:opacity-100 text-secondary-1 hover:text-danger-1 p-2"
						type="button"
						aria-label="Close"
						(click)="onCloseUrlForm()"
						appSvgIcon
						[appIcon]="'x-lg'"
						[appSquare]="'1rem'"
					></button>
				</div>
				<fieldset [disabled]="urlFormIsSubmitted">
					<fieldset
						class="flex flex-col space-y-2"
						*ngIf="urlForm.get('url') as url"
					>
						<label class="block text-secondary-2 text-sm" for="url"
							>URL address</label
						>
						<input
							id="url"
							type="text"
							class="form-control bg-primary-2 truncate"
							formControlName="url"
							placeholder="URL address"
							aria-label="Url"
						/>
						<label
							class="block text-danger-1 text-sm"
							for="url"
							*ngIf="url.touched && url.errors"
							[ngSwitch]="true"
						>
							<ng-container *ngSwitchCase="!!url.errors.required"
								>Required</ng-container
							>
							<ng-container *ngSwitchCase="!!url.errors.customValidator"
								>Url does not match pattern</ng-container
							>
						</label>
					</fieldset>
				</fieldset>
				<div class="flex flex-col space-y-2">
					<button
						class="btn btn-success md w-full"
						type="submit"
						aria-label="Submit"
						[disabled]="urlForm.invalid || urlFormIsSubmitted"
					>
						Submit
					</button>
					<ng-container *ngIf="urlFormControl.key === 'url-image'">
						<div class="flex justify-center items-center">
							<hr class="border-primary-4 w-full" />
							<span
								class="block text-secondary-2 text-sm whitespace-nowrap mx-2"
								>OR</span
							>
							<hr class="border-primary-4 w-full" />
						</div>
						<button
							class="btn btn-info md w-full"
							type="button"
							aria-label="Upload"
						>
							Upload
						</button>
					</ng-container>
				</div>
			</form>
		</div>
	</app-overlay>
</ng-container>
