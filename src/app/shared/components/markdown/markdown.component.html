<!-- @format -->

<ng-container>
	<div class="overflow-auto" #controlListElement>
		<ul
			class="menu menu-horizontal bg-base-100 rounded-box border border-base-content/20"
		>
			<li
				class="inline-block"
				[class.disabled]="disabled.value"
				*ngIf="{ value: history$.getValue().length <= 1 } as disabled"
			>
				<button
					class="fill-current"
					[class.pointer-events-none]="disabled.value"
					type="button"
					aria-label="Undo"
					title="Undo"
					(click)="onBack()"
					appSvgIcon
					[appIcon]="'arrow-left'"
				></button>
			</li>
			<li class="inline-block">
				<div class="flex p-0" appDropdown #dropdownHeading>
					<button
						class="fill-current p-3"
						type="button"
						aria-label="Heading"
						title="Heading"
						appSvgIcon
						[appIcon]="'type-h1'"
						slot="target"
					></button>
					<ul
						class="menu shadow bg-base-100 border border-base-content/20 rounded-box min-w-fit mt-2 p-2"
						slot="content"
					>
						<li class="flex w-full" *ngFor="let control of controlListHeading">
							<button
								class="text-base-content active:text-primary-content whitespace-nowrap w-full"
								type="button"
								[attr.aria-label]="control.label"
								(click)="onMarkdownControl(control)"
							>
								<span class="block" [ngClass]="control.classList">
									{{ control.label }}
								</span>
							</button>
						</li>
					</ul>
				</div>
			</li>
			<li class="inline-block">
				<div class="flex p-0" appDropdown #dropdownFormatting>
					<button
						class="fill-current p-3"
						type="button"
						aria-label="Formatting"
						title="Formatting"
						appSvgIcon
						[appIcon]="'type-bold'"
						slot="target"
					></button>
					<ul
						class="menu shadow bg-base-100 border border-base-content/20 rounded-box min-w-fit mt-2 p-2"
						slot="content"
					>
						<li
							class="flex w-full"
							*ngFor="let control of controlListFormatting"
						>
							<button
								class="text-base-content active:text-primary-content whitespace-nowrap w-full"
								type="button"
								[attr.aria-label]="control.label"
								(click)="onMarkdownControl(control)"
							>
								<span class="block" [ngClass]="control.classList">
									{{ control.label }}
								</span>
							</button>
						</li>
					</ul>
				</div>
			</li>
			<li class="inline-block">
				<div class="flex p-0" appDropdown #dropdownList>
					<button
						class="fill-current p-3"
						type="button"
						aria-label="List"
						title="List"
						appSvgIcon
						[appIcon]="'list-ul'"
						slot="target"
					></button>
					<ul
						class="menu shadow bg-base-100 border border-base-content/20 rounded-box min-w-fit mt-2 p-2"
						slot="content"
					>
						<li class="flex w-full" *ngFor="let control of controlListList">
							<button
								class="text-base-content active:text-primary-content whitespace-nowrap w-full"
								type="button"
								[attr.aria-label]="control.label"
								[attr.title]="control.label"
								(click)="onMarkdownControl(control)"
							>
								{{ control.label }}
							</button>
						</li>
					</ul>
				</div>
			</li>
			<li class="inline-block" *ngFor="let control of controlListUrl">
				<button
					class="fill-current"
					[attr.aria-label]="control.label"
					[attr.title]="control.label"
					(click)="onMarkdownControl(control)"
					appSvgIcon
					[appIcon]="control.icon"
				></button>
			</li>
		</ul>
	</div>
	<!--

	<app-overlay *ngIf="urlModal" (closed)="onCloseUrlForm()">
		<div
			class="absolute inset-0 flex justify-center items-center pointer-events-none p-4"
		>
			<form
				class="max-h-full max-w-full w-full md:w-128 flex flex-col space-y-4 bg-primary-3 rounded-lg shadow-lg pointer-events-auto p-4"
				[formGroup]="urlForm"
				(ngSubmit)="onSubmitUrlForm()"
				autocomplete="off"
			>
				<div class="flex flex-col space-y-2">
					<button
						class="btn btn-success md w-full"
						type="submit"
						aria-label="Submit"
						[disabled]="urlForm.invalid || urlFormIsSubmitted"
					>
						Submit
					</button>
					<ng-container *ngIf="urlFormControl.key === 'url-image'">
						<div class="flex justify-center items-center">
							<hr class="border-primary-4 w-full" />
							<span
								class="block text-secondary-2 text-sm whitespace-nowrap mx-2"
								>OR</span
							>
							<hr class="border-primary-4 w-full" />
						</div>
						<button
							class="btn btn-info md w-full"
							type="button"
							aria-label="Upload"
						>
							Upload
						</button>
					</ng-container>
				</div>
			</form>
		</div>
	</app-overlay>

-->

	<div
		class="modal modal-bottom md:modal-middle pointer-events-auto visible opacity-100"
		*ngIf="urlFormModal"
	>
		<div class="modal-box translate-y-0">
			<form
				class="flex flex-col rounded-none bg-base-100"
				[formGroup]="urlForm"
				(ngSubmit)="onSubmitUrlForm()"
				autocomplete="off"
			>
				<h2 class="text-xl text-base-content font-medium">
					Add {{ urlFormControl.label }}
				</h2>
				<hr class="border-base-content/20 my-2" />
				<fieldset
					class="flex flex-col space-y-4"
					[disabled]="urlFormIsSubmitted"
				>
					<fieldset class="form-control" *ngIf="urlForm.get('title') as title">
						<label class="label" for="urlFormTitle">
							<div class="indicator">
								<span
									class="indicator-item badge badge-error text-xs translate-x-full translate-y-0 w-max"
									*ngIf="title.touched && title.errors"
									[ngSwitch]="true"
								>
									<ng-container *ngSwitchCase="!!title.errors.required">
										Required
									</ng-container>
								</span>
								<span class="label-text mr-2">Title</span>
							</div>
						</label>
						<label class="block relative" for="urlFormTitle">
							<input
								id="urlFormTitle"
								type="text"
								class="input input-bordered truncate w-full pr-12"
								[class.input-success]="title.touched && !title.errors"
								[class.input-error]="title.touched && title.errors"
								[class.input-disabled]="urlFormIsSubmitted"
								formControlName="title"
								placeholder="Type your title"
								aria-label="Title"
							/>
							<button
								class="btn btn-sm btn-circle fill-current absolute top-2 right-2"
								[class.btn-success]="title.touched && title.valid"
								[class.btn-error]="title.touched && title.invalid"
								[class.btn-ghost]="title.untouched"
								type="button"
								*ngIf="title.value.length"
								aria-label="Clear"
								title="Clear"
								appSvgIcon
								[appIcon]="'x'"
								[appSquare]="'1.75rem'"
								(click)="title.setValue('')"
							></button>
						</label>
					</fieldset>
					<fieldset class="form-control" *ngIf="urlForm.get('url') as url">
						<label class="label" for="urlFormUrl">
							<div class="indicator">
								<span
									class="indicator-item badge badge-error text-xs translate-x-full translate-y-0 w-max"
									*ngIf="url.touched && url.errors"
									[ngSwitch]="true"
								>
									<ng-container *ngSwitchCase="!!url.errors.required">
										Required
									</ng-container>
									<ng-container *ngSwitchCase="!!url.errors.customValidator">
										Url does not match pattern
									</ng-container>
								</span>
								<span class="label-text mr-2">URL</span>
							</div>
						</label>
						<label class="block relative" for="urlFormUrl">
							<input
								id="urlFormUrl"
								type="text"
								class="input input-bordered truncate w-full pr-12"
								[class.input-success]="url.touched && !url.errors"
								[class.input-error]="url.touched && url.errors"
								[class.input-disabled]="urlFormIsSubmitted"
								formControlName="url"
								placeholder="Paste your URL"
								aria-label="URL"
							/>
							<button
								class="btn btn-sm btn-circle fill-current absolute top-2 right-2"
								[class.btn-success]="url.touched && url.valid"
								[class.btn-error]="url.touched && url.invalid"
								[class.btn-ghost]="url.untouched"
								type="button"
								*ngIf="url.value.length"
								aria-label="Clear"
								title="Clear"
								appSvgIcon
								[appIcon]="'x'"
								[appSquare]="'1.75rem'"
								(click)="url.setValue('')"
							></button>
						</label>
					</fieldset>
					<fieldset class="form-control">
						<button
							class="btn btn-primary w-full"
							[class.loading]="urlFormIsSubmitted"
							type="submit"
							aria-label="Login"
							[disabled]="urlForm.invalid || urlFormIsSubmitted"
						>
							Insert
						</button>
					</fieldset>
				</fieldset>
			</form>
		</div>
	</div>
</ng-container>
