<app-overlay (closed)="onClose()">
  <section class="absolute inset-0 flex justify-center items-center pointer-events-none p-4">
    <div class="max-h-full max-w-full md:w-192 flex flex-col space-y-4 bg-primary-3 rounded-lg shadow-lg pointer-events-auto p-4">
      <header class="flex justify-between items-center">
        <div class="flex items-center justify-start space-x-4">
          <a
            class="flex border border-primary-4 overflow-hidden rounded-md w-10 h-10"
            [routerLink]="['/@' + post.user.name]"
            [attr.aria-label]="post.user.name"
            [appUser]="post.user"
            appAvatar>
          </a>
          <div class="flex flex-col items-start justify-start">
            <a
              class="text-info-1 hover:underline whitespace-nowrap text-ellipsis overflow-hidden"
              [routerLink]="['/@' + post.user.name]"
              [attr.aria-label]="post.user.name">{{post.user.name}}
            </a>
            <time
              class="text-secondary-2 text-sm"
              [attr.datetime]="post.updatedAt">{{post.updatedAt | dayjs : 'fromX'}}
            </time>
          </div>
        </div>
        <button
          class="fill-current opacity-25 hover:opacity-100 text-secondary-1 hover:text-danger-1 p-2"
          type="button"
          aria-label="Close"
          appSvgIcon
          [appIcon]="'x-lg'"
          [appSquare]="'1rem'"
          (click)="onClose()">
        </button>
      </header>
      <div class="border-y border-primary-4 overflow-auto pr-4">
        <a
          class="block text-info-1 my-10"
          [routerLink]="['/edit', post.id]"
          *ngIf="post.user.id === authUser?.id">Edit this post
        </a>
        <div class="text-2xl text-secondary-1 font-medium my-4">{{post.title}}</div>
        <article class="markdown-html my-4" #article>{{post.body | markdown: article}}</article>
      </div>
      <footer class="flex items-center justify-between">
        <app-dropdown
          class="flex relative"
          *ngIf="{ value: false } as active"
          (toggled)="active.value = $event">
          <button
            class="block fill-current text-secondary-1 hover:text-info-1 p-2"
            [class.text-info-1]="active.value"
            type="button"
            aria-label="Share"
            title="Share"
            appSvgIcon
            [appIcon]="'share-fill'"
            slot="toggle">
          </button>
          <div class="absolute z-30 bottom-full left-0 flex flex-col items-start -mt-1" slot="content">
            <div class="flex bg-primary-2 rounded-md shadow-lg px-2">
              <app-share></app-share>
            </div>
            <div class="w-3 overflow-hidden inline-block mx-3">
              <div class="h-2 w-2 bg-primary-2 -rotate-45 origin-top-left"></div>
            </div>
          </div>
        </app-dropdown>
        <button
          class="block text-secondary-1 hover:text-danger-1 p-2"
          type="button"
          aria-label="Report"
          *ngIf="post.user.id !== authUser?.id">Report
        </button>
      </footer>
    </div>
  </section>
</app-overlay>
