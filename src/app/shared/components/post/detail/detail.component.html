<!-- @format -->

<ng-container *ngIf="!!post">
	<div class="flex flex-col items-start justify-start space-y-4 px-4">
		<header
			class="flex w-full flex-col items-start justify-start border-b border-base-content/20"
		>
			<div class="mt-4 flex" *ngIf="authUser?.id === post.user.id && post.id">
				<a
					class="btn btn-primary"
					aria-label="Settings"
					[routerLink]="['/edit', post.id]"
				>
					Edit
				</a>
			</div>
			<div class="grid w-full grid-cols-12 gap-4 py-4">
				<img
					class="rounded-box col-span-3 block h-full w-full object-cover"
					*ngIf="!!post.image"
					[src]="post.image"
					[alt]="post.name"
				/>
				<div
					class="flex flex-col space-y-4"
					[ngClass]="!!post.image ? 'col-span-9' : 'col-span-12'"
				>
					<div class="flex flex-col">
						<h2 class="truncate text-2xl font-medium text-base-content">
							{{ post.name }}
						</h2>
						<span class="text-sm text-base-content/40">
							{{ post.category.name }}
						</span>
					</div>
					<div class="rounded-box bg-base-200 p-4">
						{{ post.description }}
					</div>
				</div>
			</div>
		</header>
		<article class="prose max-w-none" #article>
			{{ post?.markdown || "No post markdown" | markdown: article }}
		</article>
		<footer
			class="flex w-full flex-col items-start justify-start space-y-4 border-t border-base-content/20 empty:invisible"
		>
			<div
				class="flex items-center justify-start space-x-4 py-4"
				*ngIf="authUser?.id !== post.user.id"
			>
				<a
					class="btn btn-link btn-circle"
					appAvatar
					[routerLink]="['/@' + post.user.name]"
					[attr.aria-label]="post.user.name"
					[title]="post.user.name"
					[appUser]="post.user"
				>
				</a>
				<div class="flex flex-col items-start justify-start">
					<a
						class="link"
						[routerLink]="['/@' + post.user.name]"
						[attr.aria-label]="post.user.name"
						[title]="post.user.name"
					>
						{{ post.user.name }}
					</a>
					<time
						class="text-sm text-base-content/50"
						[attr.datetime]="post.createdAt | dayjs: 'format':'YYYY-M-D'"
					>
						published {{ post.createdAt | dayjs: "fromX" }}
					</time>
				</div>
			</div>
		</footer>
	</div>
</ng-container>
