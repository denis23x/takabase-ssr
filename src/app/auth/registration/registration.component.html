<!-- @format -->

<section class="md:w-128 mx-auto p-4">
	<form
		class="bg-primary-3 border-primary-4 flex flex-col space-y-4 rounded-md border p-4"
		[formGroup]="registrationForm"
		(ngSubmit)="onSubmitForm()"
	>
		<div class="flex flex-col">
			<h2 class="text-secondary-1 text-2xl font-medium">Join to Draft</h2>
			<div class="flex space-x-1 text-base">
				<span class="text-secondary-2 block">Already have an account?</span>
				<a
					class="text-info-1 hover:underline"
					aria-label="Sign in"
					[routerLink]="['../login']"
					>Sign in</a
				>
			</div>
			<app-oauth class="mt-4 block"></app-oauth>
		</div>
		<fieldset
			class="flex flex-col space-y-4"
			[disabled]="registrationFormIsSubmitted"
		>
			<fieldset
				class="flex flex-col space-y-2"
				*ngIf="registrationForm.get('name') as name"
			>
				<label class="text-secondary-2 block text-sm" for="name"
					>Username</label
				>
				<input
					class="bg-primary-2 form-control truncate"
					id="name"
					type="text"
					aria-label="Username"
					autocomplete="username"
					formControlName="name"
					placeholder="Username"
				/>
				<label
					class="text-danger-1 block text-sm"
					for="name"
					*ngIf="name.touched && !!name.errors"
					[ngSwitch]="true"
				>
					<ng-container *ngSwitchCase="!!name.errors.required"
						>Required</ng-container
					>
					<ng-container *ngSwitchCase="!!name.errors.minlength"
						>Min length
						{{ name.errors.minlength["requiredLength"] }}
						characters</ng-container
					>
					<ng-container *ngSwitchCase="!!name.errors.maxlength"
						>Max length
						{{ name.errors.maxlength["requiredLength"] }}
						characters</ng-container
					>
				</label>
			</fieldset>
			<fieldset
				class="flex flex-col space-y-2"
				*ngIf="registrationForm.get('email') as email"
			>
				<label class="text-secondary-2 block text-sm" for="email">Email</label>
				<input
					class="bg-primary-2 form-control truncate"
					id="email"
					type="email"
					aria-label="Email"
					autocomplete="username"
					formControlName="email"
					placeholder="Email"
				/>
				<label
					class="text-danger-1 block text-sm"
					for="email"
					*ngIf="email.touched && !!email.errors"
					[ngSwitch]="true"
				>
					<ng-container *ngSwitchCase="!!email.errors.required"
						>Required</ng-container
					>
					<ng-container *ngSwitchCase="!!email.errors.email"
						>Email must be a real email address</ng-container
					>
				</label>
			</fieldset>
			<fieldset
				class="flex flex-col space-y-2"
				*ngIf="registrationForm.get('password') as password"
			>
				<label class="text-secondary-2 block text-sm" for="password"
					>Password</label
				>
				<div class="relative" *ngIf="{ value: false } as isVisible">
					<input
						class="bg-primary-2 form-control pr-10"
						id="password"
						aria-label="Password"
						autocomplete="new-password"
						formControlName="password"
						placeholder="Password"
						[type]="isVisible.value ? 'text' : 'password'"
					/>
					<i
						class="text-secondary-2 absolute top-0 right-0 cursor-pointer fill-current p-2.5 opacity-50"
						appSvgIcon
						*ngIf="!!password.value.length"
						[appIcon]="isVisible.value ? 'eye' : 'eye-slash'"
						[appSquare]="'1.35rem'"
						(touchstart)="isVisible.value = !isVisible.value"
						(mouseenter)="isVisible.value = true"
						(mouseleave)="isVisible.value = false"
					>
					</i>
				</div>
				<label
					class="text-danger-1 block text-sm"
					for="password"
					*ngIf="password.touched && !!password.errors"
					[ngSwitch]="true"
				>
					<ng-container *ngSwitchCase="!!password.errors.required"
						>Required</ng-container
					>
					<ng-container *ngSwitchCase="!!password.errors.pattern"
						>Password does not match pattern</ng-container
					>
				</label>
				<label class="text-secondary-2 block text-sm" for="password"
					>The password must be 6-32 characters long, must contain at least one
					number or special character</label
				>
			</fieldset>
			<button
				class="md btn btn-success w-full"
				type="submit"
				aria-label="Create account"
				[disabled]="registrationForm.invalid || registrationFormIsSubmitted"
			>
				Create account
			</button>
		</fieldset>
	</form>
</section>
